(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{620:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var r=s(5155),l=s(4065),a=s(2502);function o(e){let{proposals:t}=e,s={approved:t.filter(e=>"Approved"===e.status).length,inProgress:t.filter(e=>"Ongoing"===e.status).length,submitted:t.filter(e=>"Submitted"===e.status).length,rejected:t.filter(e=>"Rejected"===e.status).length},a={labels:["Approved","In Progress","Submitted","Rejected"],datasets:[{data:[s.approved,s.inProgress,s.submitted,s.rejected],backgroundColor:["#15803d","#eab308","#1d4ed8","#b91c1c"],borderWidth:0}]},o=a.datasets[0].data.reduce((e,t)=>e+t,0);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 flex flex-col items-center h-full",children:[(0,r.jsx)("h3",{className:"text-red-700 font-bold text-xl mb-6 text-center",children:"Proposal Report"}),(0,r.jsxs)("div",{className:"flex flex-col 2xl:flex-row items-center justify-center gap-6 2xl:gap-10 w-full",children:[(0,r.jsxs)("div",{className:"relative w-36 h-36 sm:w-44 sm:h-44 2xl:w-56 2xl:h-56 flex-shrink-0",children:[(0,r.jsx)(l.nu,{data:a,options:{cutout:"65%",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0}}}}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-2xl sm:text-3xl 2xl:text-4xl font-bold text-gray-900",children:o})]}),(0,r.jsx)("div",{className:"flex flex-col space-y-3 w-full 2xl:w-auto items-center 2xl:items-start",children:a.labels.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:a.datasets[0].backgroundColor[t]}}),(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[e," (",a.datasets[0].data[t],")"]})]},e))})]})]})}a.t1.register(a.Bs,a.m_,a.s$)},760:(e,t,s)=>{"use strict";s.d(t,{N:()=>b});var r=s(5155),l=s(2115),a=s(869),o=s(2885),n=s(7494),i=s(845),c=s(7351),d=s(1508);class p extends l.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,c.s)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function h(e){let{children:t,isPresent:s,anchorX:a,root:o}=e,n=(0,l.useId)(),i=(0,l.useRef)(null),c=(0,l.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:h}=(0,l.useContext)(d.Q);return(0,l.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:l,right:d}=c.current;if(s||!i.current||!e||!t)return;i.current.dataset.motionPopId=n;let p=document.createElement("style");h&&(p.nonce=h);let m=null!=o?o:document.head;return m.appendChild(p),p.sheet&&p.sheet.insertRule('\n          [data-motion-pop-id="'.concat(n,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===a?"left: ".concat(l):"right: ".concat(d),"px !important;\n            top: ").concat(r,"px !important;\n          }\n        ")),()=>{m.contains(p)&&m.removeChild(p)}},[s]),(0,r.jsx)(p,{isPresent:s,childRef:i,sizeRef:c,children:l.cloneElement(t,{ref:i})})}let m=e=>{let{children:t,initial:s,isPresent:a,onExitComplete:n,custom:c,presenceAffectsLayout:d,mode:p,anchorX:m,root:g}=e,x=(0,o.M)(u),f=(0,l.useId)(),b=!0,y=(0,l.useMemo)(()=>(b=!1,{id:f,initial:s,isPresent:a,custom:c,onExitComplete:e=>{for(let t of(x.set(e,!0),x.values()))if(!t)return;n&&n()},register:e=>(x.set(e,!1),()=>x.delete(e))}),[a,x,n]);return d&&b&&(y={...y}),(0,l.useMemo)(()=>{x.forEach((e,t)=>x.set(t,!1))},[a]),l.useEffect(()=>{a||x.size||!n||n()},[a]),"popLayout"===p&&(t=(0,r.jsx)(h,{isPresent:a,anchorX:m,root:g,children:t})),(0,r.jsx)(i.t.Provider,{value:y,children:t})};function u(){return new Map}var g=s(2082);let x=e=>e.key||"";function f(e){let t=[];return l.Children.forEach(e,e=>{(0,l.isValidElement)(e)&&t.push(e)}),t}let b=e=>{let{children:t,custom:s,initial:i=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:p="sync",propagate:h=!1,anchorX:u="left",root:b}=e,[y,j]=(0,g.xQ)(h),v=(0,l.useMemo)(()=>f(t),[t]),w=h&&!y?[]:v.map(x),N=(0,l.useRef)(!0),C=(0,l.useRef)(v),k=(0,o.M)(()=>new Map),[_,P]=(0,l.useState)(v),[E,S]=(0,l.useState)(v);(0,n.E)(()=>{N.current=!1,C.current=v;for(let e=0;e<E.length;e++){let t=x(E[e]);w.includes(t)?k.delete(t):!0!==k.get(t)&&k.set(t,!1)}},[E,w.length,w.join("-")]);let A=[];if(v!==_){let e=[...v];for(let t=0;t<E.length;t++){let s=E[t],r=x(s);w.includes(r)||(e.splice(t,0,s),A.push(s))}return"wait"===p&&A.length&&(e=A),S(f(e)),P(v),null}let{forceRender:R}=(0,l.useContext)(a.L);return(0,r.jsx)(r.Fragment,{children:E.map(e=>{let t=x(e),l=(!h||!!y)&&(v===E||w.includes(t));return(0,r.jsx)(m,{isPresent:l,initial:(!N.current||!!i)&&void 0,custom:s,presenceAffectsLayout:d,mode:p,root:b,onExitComplete:l?void 0:()=>{if(!k.has(t))return;k.set(t,!0);let e=!0;k.forEach(t=>{t||(e=!1)}),e&&(null==R||R(),S(C.current),h&&(null==j||j()),c&&c())},anchorX:u,children:e},t)})})}},4769:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var r=s(5155),l=s(2115),a=s(5695);function o(e){let{children:t}=e,s="http://localhost:5000",o=(0,a.useRouter)(),[n,i]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{let e=async()=>{let e=sessionStorage.getItem("access_token");if(!e)return void o.replace("/login");try{let t=await fetch("".concat(s,"/api/company"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){console.warn("Company fetch failed with status:",t.status),o.replace("/collabhome");return}let r=await t.json().catch(()=>null);if(!r||!r.id)return void o.replace("/collabhome");i(!1)}catch(e){console.error("Fetch error:",e.message),o.replace("/collabhome")}finally{i(!1)}};s?(console.log("API env:",s),console.log("Company URL:","".concat(s,"/api/company")),e()):console.error("NEXT_PUBLIC_API_URL is not defined")},[s,o]),(0,r.jsx)(r.Fragment,{children:t})}},4879:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(5155),l=s(620),a=s(9460),o=s(9053),n=s(4769),i=s(5695),c=s(2115),d=s(760),p=s(8274);function h(){let e=(0,i.useRouter)(),t="http://localhost:5000",[s,h]=(0,c.useState)([]),[m,u]=(0,c.useState)(!0),[g,x]=(0,c.useState)("#B11016"),f=e=>{switch(e){case"SUBMITTED":return"Submitted";case"ONGOING":return"In Progress";case"APPROVED":return"Approved";case"REJECTED":return"Rejected";default:return e}},b=async()=>{let e=sessionStorage.getItem("access_token");try{let s=await fetch("".concat(t,"/api/company"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(s.ok){let e=await s.json();e.color&&(x(e.color),console.log("Company color fetched:",e.color))}else console.warn("Failed to fetch company color, using default")}catch(e){console.error("Error fetching company color:",e)}};(0,c.useEffect)(()=>{b(),(async()=>{let e=sessionStorage.getItem("access_token");try{let s=await fetch("".concat(t,"/api/proposal"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to fetch proposals");let r=await s.json();h(Array.isArray(r)?r:r.proposals||[])}catch(e){console.error("Error fetching proposals:",e),h([])}finally{u(!1)}})()},[t]);let y=[{label:"Submitted",count:s.filter(e=>"Submitted"===f(e.status)).length,img:"/images/db_submitted.png"},{label:"In Progress",count:s.filter(e=>"In Progress"===f(e.status)).length,img:"/images/db_inprogress.png"},{label:"Approved",count:s.filter(e=>"Approved"===f(e.status)).length,img:"/images/db_approved.png"},{label:"Rejected",count:s.filter(e=>"Rejected"===f(e.status)).length,img:"/images/db_rejected.png"}],j=s.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,3);return(0,r.jsx)(o.A,{allowedRoles:["user"],children:(0,r.jsx)(n.A,{children:(0,r.jsx)(d.N,{mode:"wait",children:(0,r.jsxs)(p.P.div,{variants:{initial:{opacity:0,y:30},animate:{opacity:1,y:0,transition:{duration:.5,ease:[.25,.1,.25,1]}},exit:{opacity:0,y:-30,transition:{duration:.4,ease:[.25,.1,.25,1]}}},initial:"initial",animate:"animate",exit:"exit",className:"flex min-h-screen bg-gray-50",children:[(0,r.jsx)(a.A,{}),(0,r.jsxs)("main",{className:"flex-1 py-3 sm:py-6 pl-[2%] sm:pl-[3%] pr-[3%] sm:pr-[5%]",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between pb-2 sm:pb-4",style:{borderBottom:"3px solid ".concat(g)},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",style:{color:g},children:"Dashboard"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Track the status of all your submitted collaboration proposals with BPI."})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:()=>e.push("/proposalform"),className:"border-2 text-white px-4 py-2 rounded-md transition",style:{backgroundColor:g,borderColor:g},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.color=g},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=g,e.currentTarget.style.color="white"},children:"Create Proposal"}),(0,r.jsx)("button",{onClick:()=>e.push("/companysetup"),className:"border-2 text-white px-4 py-2 rounded-md transition",style:{backgroundColor:g,borderColor:g},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.color=g},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=g,e.currentTarget.style.color="white"},children:"Edit Company"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-[69%_30%] gap-4 mt-5",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 m-0 p-0",children:y.map((e,t)=>(0,r.jsxs)("div",{className:"bg-white rounded-lg flex items-center gap-4 drop-shadow-lg border border-gray-500",children:[(0,r.jsx)("img",{src:e.img,alt:e.label,className:"m-0 p-0 h-full w-auto object-cover"}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsx)("h2",{className:"text-4xl font-bold",children:e.count})})]},t))}),(0,r.jsxs)("div",{className:"bg-white rounded-lg drop-shadow-lg sm:p-8 p-6 border border-gray-500 h-[350px] flex flex-col",children:[(0,r.jsx)("h3",{className:"font-bold text-xl mb-4 border-b border-black pb-2 sm:pb-4",style:{color:g},children:"Recent Activities"}),(0,r.jsx)("div",{className:"relative flex-1 overflow-y-auto pr-2",style:{"--dot-size":"0.75rem"},children:0===j.length?(0,r.jsx)("p",{className:"text-gray-500 text-center mt-6",children:"No recent activities"}):j.map((e,t,s)=>(0,r.jsxs)("div",{className:"relative flex items-start",children:[(0,r.jsx)("div",{className:"relative z-10 rounded-full flex-shrink-0",style:{width:"var(--dot-size)",height:"var(--dot-size)",marginTop:"0.5rem",backgroundColor:g}}),t<s.length-1&&(0,r.jsx)("div",{className:"absolute left-[calc(var(--dot-size)/2-1px)] top-[calc(var(--dot-size)+0.5rem)] w-0.5 bg-gray-300",style:{height:"calc(100% - var(--dot-size) - 0rem)"}}),(0,r.jsxs)("div",{className:"ml-4 pb-6 last:pb-0 mb-4",children:[(0,r.jsx)("div",{className:"font-semibold text-gray-900",children:e.title}),(0,r.jsx)("div",{className:"font-bold text-gray-800 mb-1",children:f(e.status)}),(0,r.jsxs)("div",{className:"text-gray-500 text-xs",children:[new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})," | ",new Date(e.created_at).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})]})]})]},t))})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-[69%_30%] gap-4 mt-5 items-stretch",children:[(0,r.jsxs)("div",{className:"sm:col-span-1 border border-gray-500 rounded-lg p-5 bg-white drop-shadow-xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"font-bold text-lg",style:{color:g},children:"Your Proposals"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Click on any row to view details"})]}),(0,r.jsx)("div",{className:"max-h-64 overflow-y-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm rounded-lg overflow-hidden",children:[(0,r.jsx)("thead",{className:"sticky top-0 bg-white z-10",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-3 text-left",style:{color:g},children:"Proposal ID"}),(0,r.jsx)("th",{className:"p-3 text-left",style:{color:g},children:"Proposal Title"}),(0,r.jsx)("th",{className:"p-3 text-left",style:{color:g},children:"Status"}),(0,r.jsx)("th",{className:"p-3 text-center",style:{color:g},children:"Action"})]})}),(0,r.jsxs)("tbody",{children:[!m&&0===s.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"p-6 text-center text-gray-500",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("p",{children:"No proposals found"}),(0,r.jsx)("button",{onClick:()=>e.push("/proposalform"),className:"hover:underline text-sm",style:{color:g},children:"Create your first proposal"})]})})}),!m&&s.map((t,s)=>(0,r.jsxs)("tr",{className:"border-t hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>{var s;console.log("Navigating to proposal:",s=t.id),e.push("/collabproposaltracking?id=".concat(s))},children:[(0,r.jsxs)("td",{className:"p-3 font-medium",style:{color:g},children:["#",t.id]}),(0,r.jsxs)("td",{className:"p-3",children:[(0,r.jsx)("div",{className:"font-medium",children:t.title}),t.description&&(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-xs",children:t.description})]}),(0,r.jsx)("td",{className:"p-3",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("Approved"===f(t.status)?"bg-green-100 text-green-800":"Rejected"===f(t.status)?"bg-red-100 text-red-800":"In Progress"===f(t.status)?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:f(t.status)})}),(0,r.jsx)("td",{className:"p-3 text-center",children:(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})})]},s))]})]})}),m&&(0,r.jsx)("p",{className:"text-center p-3",children:"Loading proposals..."})]}),(0,r.jsx)("div",{className:"sm:col-span-1 h-full border border-gray-500 rounded-lg drop-shadow-lg",children:(0,r.jsx)(l.A,{proposals:s})})]})]})]},"dashboard-page")})})})}},5162:(e,t,s)=>{Promise.resolve().then(s.bind(s,4879))},9053:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var r=s(5155),l=s(5695),a=s(2115);function o(e){let{children:t,allowedRoles:s}=e,o=(0,l.useRouter)(),[n,i]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=sessionStorage.getItem("access_token"),t=sessionStorage.getItem("role");return e&&t?s.includes(t)?void i(!1):void o.push("/"):void o.push("/login")},[o,s]),(0,r.jsx)(r.Fragment,{children:t})}},9460:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(5155),l=s(2115),a=s(5695),o=s(8274);function n(){let e=(0,a.usePathname)(),[t,s]=(0,l.useState)(null);return(0,l.useEffect)(()=>{s(sessionStorage.getItem("role"))},[]),(0,r.jsxs)(o.P.aside,{initial:{x:-250,opacity:0},animate:{x:0,opacity:1},exit:{x:-250,opacity:0},transition:{duration:.2,ease:[.25,.1,.25,1]},className:"pl-4 group relative bg-white border-r flex flex-col items-center items-start py-4 space-y-6 h-screen w-20 hover:w-56 transition-all duration-300 overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 pl-1",children:[(0,r.jsx)("img",{src:"/logo/synsei_icon.png",alt:"Logo",className:"w-10"}),(0,r.jsx)("span",{className:"text-lg font-bold text-gray-800 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:"Synsei"})]}),(0,r.jsx)("nav",{className:"flex flex-col space-y-2 w-[92%]",children:("user"===t?[{href:"/dashboard",icon:"/images/Sidebar_home.png",label:"Home"},{href:"/collabapproved",icon:"/images/Folder_check.png",label:"Approved"},{href:"/collabinprocess",icon:"/images/folder-send.png",label:"In Process"},{href:"/collabrejected",icon:"/images/Folder_del.png",label:"Rejected"}]:"employee"===t?[{href:"/bpidashboard",icon:"/images/Sidebar_home.png",label:"Home"},{href:"/bpiapproved",icon:"/images/Folder_check.png",label:"Approved"},{href:"/bpiinprocess",icon:"/images/folder-send.png",label:"In Process"},{href:"/bpirejected",icon:"/images/Folder_del.png",label:"Rejected"},{href:"/bpifilesviewer",icon:"/images/Folder_del.png",label:"FileViewer"},{href:"/companylist",icon:"/images/building-03.png",label:"Collaborators"},{href:"/bpifindcollab",icon:"/images/peer-to-peer-02.png",label:"Find Collaborators"}]:"admin"===t?[{href:"/admindashboard",icon:"/images/Sidebar_home.png",label:"Home"},{href:"/bpiapproved",icon:"/images/Folder_check.png",label:"Approved"},{href:"/bpiinprocess",icon:"/images/folder-send.png",label:"In Process"},{href:"/bpirejected",icon:"/images/Folder_del.png",label:"Rejected"},{href:"/adminfilesviewer",icon:"/images/Folder_del.png",label:"FileViewer"},{href:"/companylist",icon:"/images/building-03.png",label:"Collaborators"},{href:"/bpifindcollab",icon:"/images/peer-to-peer-02.png",label:"Find Collaborators"}]:[]).map((t,s)=>(0,r.jsxs)("a",{href:t.href,className:"flex items-center gap-3 rounded-lg transition-all duration-200\n              ".concat(e===t.href?"bg-[#FEC2C5]":"hover:bg-gray-100","\n              px-2 py-2 w-12 group-hover:w-full"),children:[(0,r.jsx)("img",{src:t.icon,alt:t.label,className:"w-8 h-8"}),(0,r.jsx)("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap",children:t.label})]},s))})]})}}},e=>{e.O(0,[5647,8324,8579,8441,5964,7358],()=>e(e.s=5162)),_N_E=e.O()}]);