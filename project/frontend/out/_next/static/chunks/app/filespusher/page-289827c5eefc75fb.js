(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6521],{760:(e,t,n)=>{"use strict";n.d(t,{N:()=>b});var r=n(5155),a=n(2115),s=n(869),o=n(2885),l=n(7494),i=n(845),c=n(7351),d=n(1508);class u extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,n=(0,c.s)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=n-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m(e){let{children:t,isPresent:n,anchorX:s,root:o}=e,l=(0,a.useId)(),i=(0,a.useRef)(null),c=(0,a.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:m}=(0,a.useContext)(d.Q);return(0,a.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:a,right:d}=c.current;if(n||!i.current||!e||!t)return;i.current.dataset.motionPopId=l;let u=document.createElement("style");m&&(u.nonce=m);let p=null!=o?o:document.head;return p.appendChild(u),u.sheet&&u.sheet.insertRule('\n          [data-motion-pop-id="'.concat(l,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===s?"left: ".concat(a):"right: ".concat(d),"px !important;\n            top: ").concat(r,"px !important;\n          }\n        ")),()=>{p.contains(u)&&p.removeChild(u)}},[n]),(0,r.jsx)(u,{isPresent:n,childRef:i,sizeRef:c,children:a.cloneElement(t,{ref:i})})}let p=e=>{let{children:t,initial:n,isPresent:s,onExitComplete:l,custom:c,presenceAffectsLayout:d,mode:u,anchorX:p,root:h}=e,f=(0,o.M)(x),g=(0,a.useId)(),b=!0,y=(0,a.useMemo)(()=>(b=!1,{id:g,initial:n,isPresent:s,custom:c,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;l&&l()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[s,f,l]);return d&&b&&(y={...y}),(0,a.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[s]),a.useEffect(()=>{s||f.size||!l||l()},[s]),"popLayout"===u&&(t=(0,r.jsx)(m,{isPresent:s,anchorX:p,root:h,children:t})),(0,r.jsx)(i.t.Provider,{value:y,children:t})};function x(){return new Map}var h=n(2082);let f=e=>e.key||"";function g(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}let b=e=>{let{children:t,custom:n,initial:i=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:u="sync",propagate:m=!1,anchorX:x="left",root:b}=e,[y,j]=(0,h.xQ)(m),w=(0,a.useMemo)(()=>g(t),[t]),v=m&&!y?[]:w.map(f),N=(0,a.useRef)(!0),C=(0,a.useRef)(w),E=(0,o.M)(()=>new Map),[k,_]=(0,a.useState)(w),[S,P]=(0,a.useState)(w);(0,l.E)(()=>{N.current=!1,C.current=w;for(let e=0;e<S.length;e++){let t=f(S[e]);v.includes(t)?E.delete(t):!0!==E.get(t)&&E.set(t,!1)}},[S,v.length,v.join("-")]);let D=[];if(w!==k){let e=[...w];for(let t=0;t<S.length;t++){let n=S[t],r=f(n);v.includes(r)||(e.splice(t,0,n),D.push(n))}return"wait"===u&&D.length&&(e=D),P(g(e)),_(w),null}let{forceRender:O}=(0,a.useContext)(s.L);return(0,r.jsx)(r.Fragment,{children:S.map(e=>{let t=f(e),a=(!m||!!y)&&(w===S||v.includes(t));return(0,r.jsx)(p,{isPresent:a,initial:(!N.current||!!i)&&void 0,custom:n,presenceAffectsLayout:d,mode:u,root:b,onExitComplete:a?void 0:()=>{if(!E.has(t))return;E.set(t,!0);let e=!0;E.forEach(t=>{t||(e=!1)}),e&&(null==O||O(),P(C.current),m&&(null==j||j()),c&&c())},anchorX:x,children:e},t)})})}},6654:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let r=n(2115);function a(e,t){let n=(0,r.useRef)(null),a=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=n.current;e&&(n.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(n.current=s(e,r)),t&&(a.current=s(t,r))},[e,t])}function s(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let n=e(t);return"function"==typeof n?n:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9053:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(5155),a=n(5695),s=n(2115);function o(e){let{children:t,allowedRoles:n}=e,o=(0,a.useRouter)(),[l,i]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=sessionStorage.getItem("access_token"),t=sessionStorage.getItem("role");return e&&t?n.includes(t)?void i(!1):void o.push("/"):void o.push("/login")},[o,n]),(0,r.jsx)(r.Fragment,{children:t})}},9175:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var r=n(5155),a=n(2115),s=n(9053),o=n(9911),l=n(5695),i=n(6766),c=n(760),d=n(8274);let u=e=>{let{isOpen:t,onClose:n,title:a,message:s,type:l,onConfirm:i,confirmText:u="OK",cancelText:m="Cancel",showInput:p=!1,inputPlaceholder:x="",inputValue:h="",onInputChange:f}=e;if(!t)return null;let g=()=>{switch(l){case"success":return"bg-green-600 hover:bg-green-700";case"error":return"bg-red-600 hover:bg-red-700";case"warning":return"bg-yellow-600 hover:bg-yellow-700";case"info":return"bg-blue-600 hover:bg-blue-700";default:return"bg-gray-600 hover:bg-gray-700"}};return(0,r.jsx)(c.N,{children:t&&(0,r.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:(0,r.jsxs)(d.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3,ease:"easeOut"},className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6 mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(()=>{switch(l){case"success":return(0,r.jsx)(o.A7C,{className:"text-green-500 text-4xl"});case"error":return(0,r.jsx)(o.BS8,{className:"text-red-500 text-4xl"});case"warning":return(0,r.jsx)(o.BS8,{className:"text-yellow-500 text-4xl"});case"info":return(0,r.jsx)(o.__w,{className:"text-blue-500 text-4xl"});default:return(0,r.jsx)(o.__w,{className:"text-gray-500 text-4xl"})}})(),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:a})]}),(0,r.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)(o.QCr,{})})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("p",{className:"text-gray-600 leading-relaxed",children:s})}),p&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("textarea",{value:h,onChange:e=>null==f?void 0:f(e.target.value),placeholder:x,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3})}),(0,r.jsx)("div",{className:"flex justify-end space-x-3",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:n,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:m}),(0,r.jsx)("button",{onClick:()=>{i(),n()},className:"px-4 py-2 text-white rounded-lg transition-colors ".concat(g()),children:u})]}):(0,r.jsx)("button",{onClick:n,className:"px-6 py-2 text-white rounded-lg transition-colors ".concat(g()),children:u})})]},"modal")},"backdrop")})},m=e=>{let{isOpen:t,message:n}=e;return(0,r.jsx)(c.N,{children:t&&(0,r.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:(0,r.jsx)(d.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3,ease:"easeOut"},className:"bg-white rounded-lg shadow-xl p-6 mx-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#B11016]"}),(0,r.jsx)("p",{className:"text-gray-700 font-medium",children:n})]})},"loading-box")},"loading-backdrop")})};function p(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading..."}),children:(0,r.jsx)(x,{})})}function x(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),n=null==t?void 0:t.get("id"),c="http://localhost:5000",[d,p]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[f,g]=(0,a.useState)(!0),[b,y]=(0,a.useState)(""),[j,w]=(0,a.useState)(null),[v,N]=(0,a.useState)(null),[C,E]=(0,a.useState)(!1),[k,_]=(0,a.useState)([]),[S,P]=(0,a.useState)([]),[D,O]=(0,a.useState)(!1),[T,R]=(0,a.useState)(null),[I,A]=(0,a.useState)(""),[U,B]=(0,a.useState)(""),F=(0,a.useRef)(null),[z,M]=(0,a.useState)({isOpen:!1,title:"",message:"",type:"info"}),[L,Y]=(0,a.useState)({isOpen:!1,message:""}),[V,Q]=(0,a.useState)(""),[W,G]=(0,a.useState)([]),J=(e,t)=>{M({isOpen:!0,title:"Success",message:e,type:"success",onConfirm:t,confirmText:"OK"})},H=e=>{M({isOpen:!0,title:"Error",message:e,type:"error",confirmText:"OK"})},K=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Continue";M({isOpen:!0,title:"Warning",message:e,type:"warning",onConfirm:t,confirmText:n,cancelText:"Cancel"})},X=e=>{Y({isOpen:!0,message:e})},q=()=>{Y({isOpen:!1,message:""})},Z=async()=>{try{let e=sessionStorage.getItem("access_token");if(!e)throw Error("No token found.");let t=await fetch("".concat(c,"/api/department"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch departments: ".concat(t.status));let n=await t.json();console.log("Fetched departments response:",n);let r=n.departments||[];return P(r),r}catch(e){throw console.error("Error fetching departments:",e),e}};(0,a.useEffect)(()=>{let e=sessionStorage.getItem("access_token");(async()=>{if(e)try{var t,n;console.log("=== Fetching User Department from API ===");let r=await fetch("".concat(c,"/api/user/me"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok)throw Error("Failed to fetch user details");let a=await r.json();console.log("✅ User data fetched:",a);let s=a.department_id||(null==(t=a.user)?void 0:t.department_id);a.department_name||null==(n=a.user)||n.department_name,s?N(s):(console.warn("❌ Department ID missing in user data"),N(null))}catch(e){console.error("Error fetching user department:",e),N(null)}})()},[c]);let $=async()=>{if(!T||!n)return void H("Please select a file first.");if(!C)return void H("You can only update documents that are currently at your department.");try{X("Updating file...");let e=sessionStorage.getItem("access_token");if(!e)throw Error("No token found.");let t=new FormData;t.append("file",T);let r=await fetch("".concat(c,"/api/document_setting/update/").concat(n),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:t}),a=await r.text();if(console.log("Update response:",a),q(),!r.ok)throw Error("Update failed: ".concat(a));J("File updated successfully!",()=>{O(!1),R(null),A(""),B(""),window.location.reload()})}catch(t){q();let e=t instanceof Error?t.message:"Error updating file.";console.error(e),H("Error updating file: ".concat(e))}},ee=()=>!!j&&j.iteration.indexOf(j.current_location)>=j.iteration.length-1,et=async()=>n&&j?C?ee()?void K("This document is already at the final department."):void K("Are you sure you want to push this document to the next department? This action cannot be undone.",async()=>{try{X("Pushing document to next department...");let e=sessionStorage.getItem("access_token");if(!e)throw Error("No token found.");let t=await fetch("".concat(c,"/api/document_setting/push/").concat(n),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(q(),!t.ok){let e=await t.text();throw Error("Push failed: ".concat(e))}await t.json(),J("Document pushed to next department successfully!",()=>{window.location.reload()})}catch(t){q(),console.error("Error pushing document:",t);let e=t instanceof Error?t.message:"Unknown error";H("Error pushing document: ".concat(e))}},"Push Document"):void H("You can only push documents that are currently at your department."):void H("No document setting found."),en=async(e,t)=>{let r=sessionStorage.getItem("access_token");if(r){if(!n)return void H("No document setting found.");if(!C)return void H("You can only update documents that are currently at your department.");try{if(X("".concat("APPROVED"===e?"Approving":"REJECTED"===e?"Rejecting":"Updating"," document...")),"APPROVED"===e){let e=await fetch("".concat(c,"/api/document_setting/setapproved/").concat(n),{method:"PUT",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(q(),!e.ok){let t=await e.json().catch(()=>({error:"Unknown error"}));throw Error(t.error||"Failed to set approval")}let t=await e.json();w(e=>e?{...e,approved:t.approved,updated_at:new Date().toISOString()}:null),J("Document approved successfully!",()=>{window.location.reload()});return}if("REJECTED"===e){q(),J("Document rejected successfully!",()=>{window.location.reload()});return}q(),J("Document status updated successfully!",()=>{window.location.reload()})}catch(t){q(),console.error("Error updating document setting:",t);let e=t instanceof Error?t.message:"Unknown error";H("Error updating document setting: ".concat(e))}}},er=async()=>{if(!ee())return void H("You can only approve documents at the final department.");K("Are you sure you want to approve this document? This action will mark the document as approved.",()=>en("APPROVED"),"Approve Document")},ea=async()=>{if(!ee())return void H("You can only reject documents at the final department.");Q(""),M({isOpen:!0,title:"Reject Document",message:"Please provide a reason for rejection:",type:"warning",showInput:!0,inputPlaceholder:"Enter rejection reason (optional)...",inputValue:V,onInputChange:Q,onConfirm:()=>(e=>en("REJECTED",e||"No reason provided"))(V),confirmText:"Submit",cancelText:"Cancel"})},es=e=>{let t=S.find(t=>t.id===e);return t?t.name:"Department ".concat(e)},eo=async()=>{if(console.log("Refreshing user access..."),j&&null!==v){let e=j.current_location===v;E(e),console.log("Updated access:",{canInteract:e,currentLocation:j.current_location,userDept:v})}};return((0,a.useEffect)(()=>{if(!n){y("No document setting ID provided"),g(!1);return}(async()=>{try{g(!0),y("");try{await Z()}catch(e){console.error("Failed to fetch departments:",e),y("Failed to load departments. Please try again.");return}let e=sessionStorage.getItem("access_token");if(!e)throw Error("No authentication token found. Please log in again.");console.log("Attempting to fetch from:","".concat(c,"/api/document_setting/").concat(n));let t=await fetch("".concat(c,"/api/document_setting/").concat(n),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",Accept:"application/json"}});if(console.log("Response status:",t.status),!t.ok){let e="Failed to fetch document setting: ".concat(t.status);try{let n=await t.json();e=n.error||n.message||e}catch(n){e="HTTP ".concat(t.status,": ").concat(t.statusText)}throw Error(e)}let r=await t.json();console.log("Received document setting:",r),w(r),p(r.document_name||"Document Setting ".concat(n)),h(r.document_description||"Push the files to the departments for review and approval"),setTimeout(()=>eo(),100)}catch(e){console.error("Error fetching document setting:",e),y(e instanceof Error?e.message:"Failed to fetch document data"),p("Document Setting ".concat(n)),h("Push the files to the departments for review and approval"),G([])}finally{g(!1)}})()},[n,c]),(0,a.useEffect)(()=>{var e,t;j&&S.length>0&&(e=j.iteration,t=j.current_location,S.length&&_(e.map(n=>{let r=S.find(e=>e.id===n),a=e.indexOf(t),s=e.indexOf(n);return{id:n,name:r?r.name:"Department ".concat(n),isActive:n===t,isCompleted:s<a}})),G(j.iteration.map((e,t)=>{let n=es(e);return j.iteration.indexOf(j.current_location),{id:"".concat(j.document_id,"-").concat(e),name:j.document_name,details:j.document_description||"Document file",dateCreated:j.document_created_at?new Date(j.document_created_at).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],isSelected:!1,department:n,downloadUrl:"".concat(c,"/api/document/download_file/").concat(j.document_id),currentLocation:j.current_location,iteration:j.iteration}})))},[j,S]),(0,a.useEffect)(()=>{if(j&&null!==v){let e=j.current_location===v;E(e),console.log("Can user interact:",e,"Current location:",j.current_location,"User dept:",v)}},[j,v]),f)?(0,r.jsx)(s.A,{allowedRoles:["user","employee","admin"],children:(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#B11016] mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading document..."})]})})}):(0,r.jsx)(s.A,{allowedRoles:["user","employee","admin"],children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center px-4 sm:px-[5%] lg:px-[10%] py-4 sm:py-8",children:[(0,r.jsxs)("div",{className:"relative flex items-center w-full mt-2 mb-4",children:[(0,r.jsxs)("button",{onClick:()=>e.back(),className:"absolute left-0 flex items-center text-[#B11016] hover:text-[#800b10] text-sm sm:text-base",children:[(0,r.jsx)(o.QVr,{className:"mr-2"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Back"})]}),(0,r.jsxs)("div",{className:"text-center w-full",children:[(0,r.jsx)("h1",{className:"text-xl sm:text-2xl lg:text-4xl font-bold text-[#B11016] pb-2 sm:pb-4",children:"Files Pusher"}),(0,r.jsx)("p",{className:"text-sm sm:text-md text-black mb-4 sm:mb-6 px-4",children:"Push the files to the departments for review and approval."}),(0,r.jsx)("div",{className:"mx-2 border-b-[3px] border-[#B11016]"})]})]}),b&&(0,r.jsx)("div",{className:"w-full max-w-6xl mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:(0,r.jsx)("p",{className:"text-sm",children:b})}),null===v&&(0,r.jsx)("div",{className:"w-full max-w-6xl mb-4 p-4 bg-blue-100 border border-blue-400 text-blue-700 rounded",children:(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Note:"})," Department information not found.",(0,r.jsx)("button",{onClick:eo,className:"ml-2 px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Refresh Access"})]})}),!C&&j&&null!==v&&(0,r.jsx)("div",{className:"w-full max-w-6xl mb-4 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded",children:(0,r.jsxs)("p",{className:"text-sm",children:["This document is currently at ",es(j.current_location),". You can only interact with documents that are at your department (Department ID: ",v,").",(0,r.jsx)("button",{onClick:eo,className:"ml-2 px-2 py-1 bg-yellow-600 text-white text-xs rounded hover:bg-yellow-700",children:"Refresh Access"})]})}),(0,r.jsxs)("div",{className:"w-full max-w-6xl mt-2 grid grid-cols-3 gap-4 text-lg font-semibold text-gray-800",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-[#B11016] font-bold",children:"File Name:"})," ",d]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-[#B11016] font-bold",children:"File Description:"}),"  ",x]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-[#B11016] font-bold",children:"Date created:"})," ",W.length>0?W[0].dateCreated:"N/A"]})]}),(0,r.jsxs)("div",{className:"w-full max-w-6xl mt-6 mb-8",children:[(0,r.jsx)("div",{className:"flex space-x-2 w-full mb-6",children:k.map(e=>(0,r.jsx)("div",{className:"flex-1 h-10 rounded flex items-center justify-center text-xs font-medium transition-colors duration-300 ".concat(e.isCompleted?"bg-[#333333] text-white":e.isActive?"bg-[#B11016] text-white":"bg-gray-300 text-gray-700"),children:(0,r.jsx)("span",{className:"text-center px-1 truncate",title:e.name,children:e.name})},e.id))}),(0,r.jsx)("div",{className:"flex space-x-2 w-full",children:k.map(e=>{let t=W.find(t=>t.department===e.name);return(0,r.jsx)("div",{className:"flex-1 flex flex-col items-center",children:t?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"cursor-pointer transition-all duration-200 ".concat(t.isSelected?"transform scale-105":""),onClick:()=>{G(e=>e.map(e=>e.id===t.id?{...e,isSelected:!e.isSelected}:e))},children:(0,r.jsx)("div",{className:"relative mb-4",children:(0,r.jsx)(i.default,{src:t.isSelected?"/images/file-card-black.png":(e=>{if(!j)return"/images/file-card.png";let t=j.iteration.indexOf(j.current_location);return j.iteration.findIndex(t=>es(t)===e.department)<t?"/images/file-card-black.png":"/images/file-card.png"})(t),alt:"File Card",width:120,height:144,className:"mx-auto"})})}),(0,r.jsx)("div",{className:"text-xs font-medium text-gray-800 mb-2 truncate px-1",title:t.name,children:t.name}),(0,r.jsxs)("button",{onClick:()=>(e=>{if(!e.downloadUrl)return void H("No download URL available for this file");console.log("Opening download URL:",e.downloadUrl),window.open(e.downloadUrl,"_blank")})(t),className:"px-3 py-1 bg-[#B11016] text-white text-xs rounded hover:bg-[#800b10] transition-colors flex items-center justify-center mx-auto",disabled:!t.downloadUrl,children:[(0,r.jsx)(o.WCW,{className:"mr-1",size:10}),"Download"]})]}):(0,r.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,r.jsx)(o.t69,{className:"mx-auto text-2xl mb-2 opacity-30"}),(0,r.jsx)("p",{className:"text-xs",children:"No file"})]})},e.id)})}),0===W.length&&(0,r.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,r.jsx)(o.t69,{className:"mx-auto text-4xl mb-4 opacity-30"}),(0,r.jsx)("p",{className:"text-sm sm:text-base",children:"No document available"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Document will appear here when loaded"})]})]}),(0,r.jsxs)("div",{className:"w-full max-w-6xl mb-8",children:[(0,r.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>O(!0),disabled:!C||null===v,className:"".concat((ee(),"w-full max-w-xs")," px-6 py-3 rounded transition-colors ").concat(C&&null!==v?"bg-[#333333] text-white hover:bg-[#0f0f0f]":"bg-gray-400 text-gray-600 cursor-not-allowed"),children:"Update"}),!ee()&&(0,r.jsx)("button",{onClick:et,disabled:!C||null===v,className:"w-full max-w-xs px-6 py-3 rounded transition-colors ".concat(C&&null!==v?"bg-[#B11016] text-white hover:bg-[#800b10]":"bg-gray-400 text-gray-600 cursor-not-allowed"),children:"Push"}),ee()&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:er,disabled:!C||null===v,className:"w-full max-w-xs px-6 py-3 rounded transition-colors flex items-center justify-center ".concat(C&&null!==v?"bg-green-600 text-white hover:bg-green-700":"bg-gray-400 text-gray-600 cursor-not-allowed"),children:[(0,r.jsx)(o.CMH,{className:"mr-2"}),"Approve"]}),(0,r.jsxs)("button",{onClick:ea,disabled:!C||null===v,className:"w-full max-w-xs px-6 py-3 rounded transition-colors flex items-center justify-center ".concat(C&&null!==v?"bg-red-600 text-white hover:bg-red-700":"bg-gray-400 text-gray-600 cursor-not-allowed"),children:[(0,r.jsx)(o.QCr,{className:"mr-2"}),"Reject"]})]})]}),(0,r.jsx)("div",{className:"text-center text-sm text-gray-500 mt-2 space-y-1",children:null===v?(0,r.jsx)("p",{children:"Department information not available. Please check your login setup or refresh access."}):C?ee()?(0,r.jsx)("p",{children:"Document has reached the final department. You can update, approve, or reject the document."}):(0,r.jsx)("p",{children:"You can update the document or push it to the next department."}):(0,r.jsx)("p",{children:"You can only interact with documents that are currently at your department."})})]}),D&&(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6 relative mx-4",children:[(0,r.jsx)("button",{onClick:()=>{O(!1),R(null),A(""),B("")},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700",children:(0,r.jsx)(o.QCr,{})}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-[#B11016] mb-4",children:"Update File"}),(0,r.jsxs)("div",{onDrop:e=>{e.preventDefault(),e.dataTransfer.files&&e.dataTransfer.files.length>0&&R(e.dataTransfer.files[0])},onDragOver:e=>e.preventDefault(),className:"border-2 border-dashed border-red-300 rounded-lg p-6 text-center cursor-pointer hover:border-red-500 transition mb-4",onClick:()=>{var e;return null==(e=F.current)?void 0:e.click()},children:[(0,r.jsx)("img",{src:"/images/uploadicon.png",alt:"Upload Icon",className:"mx-auto h-12 w-12 object-contain"}),(0,r.jsxs)("p",{className:"mt-2 text-gray-600 text-sm",children:["Drag & drop files or"," ",(0,r.jsx)("span",{className:"text-red-600 underline",children:"Browse"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"Supported formats: JPEG, PNG, PDF, DOCX"}),(0,r.jsx)("input",{type:"file",accept:".jpeg,.jpg,.png,.pdf,.docx",ref:F,className:"hidden",onChange:e=>{e.target.files&&e.target.files.length>0&&R(e.target.files[0])}})]}),T&&(0,r.jsxs)("div",{className:"mb-4 p-2 border border-green-400 rounded bg-green-50 text-green-700 text-sm",children:["Selected: ",T.name]}),(0,r.jsx)("button",{onClick:$,disabled:!T,className:"w-full px-4 py-2 bg-[#B11016] text-white rounded hover:bg-[#800b10] transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Update File"})]})}),(0,r.jsx)(u,{isOpen:z.isOpen,onClose:()=>{M({isOpen:!1,title:"",message:"",type:"info"})},title:z.title,message:z.message,type:z.type,onConfirm:z.onConfirm,confirmText:z.confirmText,cancelText:z.cancelText,showInput:z.showInput,inputPlaceholder:z.inputPlaceholder,inputValue:z.inputValue,onInputChange:z.onInputChange}),(0,r.jsx)(m,{isOpen:L.isOpen,message:L.message})]})})}},9906:(e,t,n)=>{Promise.resolve().then(n.bind(n,9175))}},e=>{e.O(0,[6711,8324,5751,8441,5964,7358],()=>e(e.s=9906)),_N_E=e.O()}]);